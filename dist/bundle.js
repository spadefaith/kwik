var Kwik=(()=>{var S=Object.defineProperty;var T=Object.getOwnPropertyDescriptor;var v=Object.getOwnPropertyNames;var $=Object.prototype.hasOwnProperty;var H=(t,e)=>{for(var n in e)S(t,n,{get:e[n],enumerable:!0})},I=(t,e,n,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of v(e))!$.call(t,r)&&r!==n&&S(t,r,{get:()=>e[r],enumerable:!(s=T(e,r))||s.enumerable});return t};var L=t=>I(S({},"__esModule",{value:!0}),t);var j={};H(j,{Blueprint:()=>b,Component:()=>k,createSignal:()=>f});var x=(t,e)=>{let n="//comment()",s=[],r=document.evaluate(n,t,null,XPathResult.UNORDERED_NODE_SNAPSHOT_TYPE,null);for(let i=0,a=r.snapshotLength;i<a;++i){let l=r.snapshotItem(i);e?e==l.nodeValue&&s.push(l):s.push(l)}return s},h=t=>new DOMParser().parseFromString(t,"text/html").body;var m=class{renderFunction;component;jsx;events;signals;constructor(e){this.component=e;let n=e.template;this.renderFunction=null,typeof n=="function"?(this.renderFunction=n,this.jsx=n()):this.jsx=n,this.events=[],this.signals=[]}toHtml(){let e=this.jsx,n=h(e);return this.component.events.forEach(s=>{let{type:r,id:i,handler:a}=s,l=n.querySelector(`[data-event=click-${i}]`);l&&l.addEventListener(r,u=>{a(u)})}),{str:e,html:n}}};var M=(t,{connectedCallback:e,disconnectedCallback:n,attributeChangedCallback:s,updateCallback:r})=>{let i=t.id,a=t.name,l=t.attributes,u=t.template,o=new m(t),c=null,y="";return customElements.get(a)||customElements.define(a,class extends HTMLElement{static observedAttributes=[...l,"key"];constructor(){super()}connectedCallback(){if(typeof u=="function"){let{str:C,html:_}=o.toHtml();c=_}y=this.innerHTML,this.innerHTML="";let g=c.childNodes;[...h(y).childNodes,...g].forEach(C=>{this.appendChild(C)}),e(this)}disconnectedCallback(){n()}adoptedCallback(){}attributeChangedCallback(g,C,_){s(g,C,_)}}),customElements.get(a)},E=M;var d=()=>`a${crypto.randomUUID().replaceAll("-","")}a`;function f(t){let e=t,n=[];function s(){for(let r of n)r(e)}return{id:d(),get value(){return e},set value(r){e=r,s()},subscribe:r=>{n.push(r)},toString:()=>e.toString(),get isSignal(){return!0}}}var p=class{constructor(e){this.array=e;this.array=e}get data(){return Array.isArray(this.array)?this:this.array}each(e){return this.array.map(e).join("")}};var D=class{name;id;attributes;template;callback;custom;componentCallback;componentDisconnectCallback;signals;styles;events;constructor(t){this.callback=t,this.id=d(),this.name=`x-${this.id}`,this.attributes=[],this.template={},this.signals={},this.styles={},this.events=[],this._createTemplate(),this._createCustom()}_createTemplate(){let t=this.callback({node:this._nodeCallback.bind(this),render:this._renderCallback.bind(this),attr:this._attrCallback.bind(this),events:this._eventsCallback.bind(this),connectedCallback:this._connectedCallback.bind(this),props:this._propsCallback.bind(this),style:this._styleCallback.bind(this)});this.template=t}_styleCallback(t){let e=d();return this.styles[e]=t,Object.keys(t).forEach(n=>{let s=t[n];s.isSignal&&(this._registerSignal(n,s),s.subscribe(r=>{let i=document.querySelector(`[data-style=${e}]`);i&&(i.style[n]=r)}))}),`data-style=${e}`}_propsCallback(t,e){this.attributes.push(t);let n=f(e);return this._registerSignal(t,n),n}_connectedCallback(t){this.componentCallback=t}_eventsCallback(t){return Object.keys(t).map(e=>{let n=t[e],s=d();return this.events.push({id:s,type:e,handler:n}),`data-event=${e}-${s}`}).join(" ")}_attrCallback(t,e){return e.isSignal&&(this._registerSignal(e.id,e),e.subscribe(n=>{})),`${t}=${e}`}_nodeCallback(t){return this._registerSignal(t.id,t),t.subscribe(e=>{let n=t.id,s=document.querySelector(this.name);s&&setTimeout(()=>{let r=x(s,`node ${n}`);r.length&&r.forEach(i=>{let a=i.nextSibling;a.nodeType==3&&(a.nodeValue[0]==" "?a.nodeValue=` ${t}`:a.nodeValue=t)})})}),`<!--node ${t.id}--> ${t}`}_createCustom(){this.custom=E(this,{updateCallback:t=>{},connectedCallback:t=>{Object.keys(this.styles).forEach(e=>{let n=this.styles[e],s=document.querySelector(`[data-style=${e}]`);s&&Object.keys(n).forEach(r=>{s.style[r]=n[r]})}),this.componentCallback&&(this.componentDisconnectCallback=this.componentCallback(t))},disconnectedCallback:()=>{this.componentDisconnectCallback&&this.componentDisconnectCallback()},attributeChangedCallback:(t,e,n)=>{this.signals[t]&&this.signals[t].forEach(s=>{e!=n&&(s.value=n)})}})}_renderCallback(t,e,n={}){let s=typeof e=="string",r=typeof e=="function";return n.replace==null&&(n.replace=!!s),t.subscribe(i=>{Array.isArray(i)&&(i=new p(i).data);let a=t.id,l=document.querySelector(this.name);l&&setTimeout(()=>{let u=x(l,`render ${a}`);u.length&&u.forEach(o=>{let c=null;if(s)if(n.renderer)c=n.renderer.render(e,{list:i});else throw new Error("renderer is required");else r&&(c=e(i));if(o.isInitialized||(o.isInitialized=!0),o.isInitialized&&n.replace&&o.nextSibling.remove(),!c)return;let y=h(c);o.parentElement.insertBefore(y.firstChild,o.nextSibling)})})}),`<!--render ${t.id}-->`}_registerSignal(t,e){this.signals[t]||(this.signals[t]=[]),this.signals[t].push(e)}},k=D;var b=class{callback;current;constructor(e){this.callback=e,this.current=null}toString(){return this.current=new k(this.callback),this.current.name}close(){return this.current.name}};return L(j);})();
//# sourceMappingURL=bundle.js.map
